function RandomNumBoth(t,e){var i=e-t,n=Math.random(),o=t+n*i;return o}function RandomNumBoth_Int(t,e){var i=e-t,n=Math.random(),o=t+Math.round(n*i);return o}function playAnimations(t,e){if(e)for(var i in t.items)t.items[i].props={loop:!0};t.play()}function distance(x1,x2,y1,y2){var x1=x1,y1=eval(y1),x2=eval(x2),y2=eval(y2),calX=x2-x1,calY=y2-y1;return Math.pow(calX*calX+calY*calY,.5)}function throttle(t,e){var i,n=t,o=!0;return function(){var t=arguments,r=this;return o?(n.apply(r,t),o=!1):i?!1:void(i=setTimeout(function(){clearTimeout(i),i=null,n.apply(r,t)},e||500))}}function playAnimation(t,e){if(e)for(var i in t.items)t.items[i].props={loop:!0};t.play()}var __reflect=this&&this.__reflect||function(t,e,i){t.__class__=e,i?i.push(e):i=[e],t.__types__=t.__types__?i.concat(t.__types__):i},__extends=this&&this.__extends||function(t,e){function i(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);i.prototype=e.prototype,t.prototype=new i},__awaiter=this&&this.__awaiter||function(t,e,i,n){return new(i||(i=Promise))(function(o,r){function s(t){try{h(n.next(t))}catch(e){r(e)}}function a(t){try{h(n["throw"](t))}catch(e){r(e)}}function h(t){t.done?o(t.value):new i(function(e){e(t.value)}).then(s,a)}h((n=n.apply(t,e||[])).next())})},__generator=this&&this.__generator||function(t,e){function i(t){return function(e){return n([t,e])}}function n(i){if(o)throw new TypeError("Generator is already executing.");for(;h;)try{if(o=1,r&&(s=r[2&i[0]?"return":i[0]?"throw":"next"])&&!(s=s.call(r,i[1])).done)return s;switch(r=0,s&&(i=[0,s.value]),i[0]){case 0:case 1:s=i;break;case 4:return h.label++,{value:i[1],done:!1};case 5:h.label++,r=i[1],i=[0];continue;case 7:i=h.ops.pop(),h.trys.pop();continue;default:if(s=h.trys,!(s=s.length>0&&s[s.length-1])&&(6===i[0]||2===i[0])){h=0;continue}if(3===i[0]&&(!s||i[1]>s[0]&&i[1]<s[3])){h.label=i[1];break}if(6===i[0]&&h.label<s[1]){h.label=s[1],s=i;break}if(s&&h.label<s[2]){h.label=s[2],h.ops.push(i);break}s[2]&&h.ops.pop(),h.trys.pop();continue}i=e.call(t,h)}catch(n){i=[6,n],r=0}finally{o=s=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}var o,r,s,a,h={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return a={next:i(0),"throw":i(1),"return":i(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a},AssetAdapter=function(){function t(){}return t.prototype.getAsset=function(t,e,i){function n(n){e.call(i,n,t)}if(RES.hasRes(t)){var o=RES.getRes(t);o?n(o):RES.getResAsync(t,n,this)}else RES.getResByUrl(t,n,this,RES.ResourceItem.TYPE_IMAGE)},t}();__reflect(AssetAdapter.prototype,"AssetAdapter",["eui.IAssetAdapter"]);var tips={a:"熟练技能球",b:"请点炸所有技能球",end:"恭喜你,进入下一关",SkillPoints:["ES6","Html5","CSS3","调试","布局","Vue","Node.js","Egret","Webpack","Linux","Nginx","Git","Mysql","Fiddler","Python"],SkillPoints2:["ReactNative","Flutter"]},Ball=function(t){function e(){var e=t.call(this)||this;return e.name="Ball",e.SkillPoints=tips.SkillPoints,e.SkillPoints_index=0,e.SkillPoints_count=0,e.bugNum=0,e.intval=null,e.addEventListener(eui.UIEvent.CREATION_COMPLETE,e.init,e),e.skinName="BallSkin",e}return __extends(e,t),e.getInstance=function(t){return null===this._instance&&(this._instance=new e,this._parent=t),e._instance},e.prototype.childrenCreated=function(){console.log("childrenCreated",this.bottoms.x),playAnimations(this.cannnonRotate,!0)},e.prototype.loadRobot=function(){var t=RES.getRes("robot_json"),e=RES.getRes("robot_png"),i=new egret.MovieClipDataFactory(t,e),n=this.robot=new egret.MovieClip(i.generateMovieClipData("walk"));n.frameRate=42,n.scaleX=n.scaleY=.4,n.width=n.height=100,n.anchorOffsetX=n.anchorOffsetY=160,this.addChild(n)},e.prototype.loadBooms=function(){var t=RES.getRes("booms_json"),e=RES.getRes("booms_png"),i=new egret.MovieClipDataFactory(t,e),n=this.booms=new egret.MovieClip(i.generateMovieClipData("boom"));n.anchorOffsetX=n.anchorOffsetY=140,n.scaleX=n.scaleY=.5,n.visible=!1,this.addChild(n)},e.prototype.init=function(){this.loadRobot(),this.loadBooms(),console.log("init",this.bottoms.x,this.bottoms);var t=(Matter.Engine,Matter.Render,Matter.Runner,Matter.MouseConstraint,Matter.Mouse,Matter.World,Matter.Bodies,this.engine=Matter.Engine.create(null,{})),e=t.world,i=Matter.Runner.create(null);i.isFixed=!0;var n=EgretRender.create({element:this,engine:t,options:{width:this.width,height:this.height,container:this,wireframes:!0}});e.bounds.max={x:this.width,y:this.height},Matter.Runner.run(i,t),EgretRender.run(n),t.world.gravity.y=.2,console.log("容器",Matter.Bodies,this.lefts.height);var o=(Matter.Body.nextGroup(!1),Matter.Bodies.rectangle(this.lefts.x,this.lefts.y,this.lefts.width,this.lefts.height,{isStatic:!0,friction:.2,container:this,egretSprite:this.lefts})),r=Matter.Bodies.rectangle(this.rights.x,this.rights.y,this.rights.width,this.rights.height,{isStatic:!0,friction:.2,container:this,egretSprite:this.rights});Matter.World.add(t.world,[Matter.Bodies.rectangle(this.tops.x,this.tops.y,this.tops.width,this.tops.height,{isStatic:!0,friction:.2,container:this,egretSprite:this.tops}),Matter.Bodies.rectangle(this.bottoms.x,this.bottoms.y,this.bottoms.width,this.bottoms.height,{isStatic:!0,friction:0,container:this,egretSprite:this.bottoms,collisionFilter:{group:1}}),o,r]),console.log("world",e,r);var s=0;Matter.Events.on(t,"collisionStart",function(t){var e=t.pairs;s++;for(var i=0;i<e.length;i++){var n=e[i];console.log("kk:"+s,n,e),"line"===n.bodyB.label}}),this.addEvents(),this.start()},e.prototype.addEvents=function(){var t=this;this.bronBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.tapBtn,this),this.addEventListener(egret.TouchEvent.TOUCH_TAP,this.moveRobot,this),this.reset.addEventListener(egret.TouchEvent.TOUCH_TAP,this.resets,this),this.next.addEventListener(egret.TouchEvent.TOUCH_TAP,this.nexts,this),window.addEventListener("deviceorientation",this.deviceorientation,!0),this.intval=egret.setInterval(function(){t.$children.forEach(function(e){e.body&&(e.x<-1||e.x>t.width||e.y<-1||e.y>t.height)&&(console.log("BUG",e),t.destroyPaoPao(e),t.bugNum++)})},this,1e3)},e.prototype.deviceorientation=function(t){var e=Number((Math.log(Math.abs(t.beta))/5).toFixed(2)),i=Number((Math.log(Math.abs(t.gamma))/5).toFixed(2));t.beta<0&&(e*=-1),t.gamma<0&&(i*=-1),this.engine.world.gravity.x=i,this.engine.world.gravity.y=e},e.prototype.removeEvents=function(){this.bronBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.tapBtn,this),egret.clearInterval(this.intval),window.removeEventListener("deviceorientation",this.deviceorientation,!0)},e.prototype.tapBtn=function(){this.SkillPoints_index++,this.SkillPoints_index===this.SkillPoints.length&&(this.bronBtn.visible=!1,this.tips.text=tips.b,this.cannnonRotate.stop()),this.punchPaoPao(this.LastPaoPao),this.SkillPoints_index<=this.SkillPoints.length-1&&this.createPaoPao()},e.prototype.createPaoPao=function(){var t=30,e=new egret.DisplayObjectContainer,i=this.createBitmapByName("ball_"+RandomNumBoth_Int(1,6)+"_png");e.width=e.height=i.width=i.height=2*t,i.anchorOffsetX=i.anchorOffsetY=t,e.addChild(i);var n=new egret.TextField;n.text=this.SkillPoints[this.SkillPoints_index],n.anchorOffsetX=n.anchorOffsetY=t,n.width=n.height=2*t,n.textColor=0,n.fontFamily="Impact",n.textAlign=egret.HorizontalAlign.CENTER,n.verticalAlign=egret.VerticalAlign.MIDDLE,n.size=2*t/4,e.name=this.SkillPoints[this.SkillPoints_index],e.addChild(n);var o=Matter.Bodies.circle(this.cannon.x,this.cannon.y,t,{egretSprite:e,container:this,friction:.2,isSleeping:!0,restitution:.4},20);return Matter.World.add(this.engine.world,o),e.body=o,this.LastPaoPao=e,e},e.prototype.punchPaoPao=function(t){var e=t.body;e.isSleeping=!1,Matter.Body.applyForce(e,e.position,{x:RandomNumBoth(-.2,.2),y:RandomNumBoth(0,.5)}),RES.getRes("wind_mp3").play(0,1),t.touchEnabled=!0,t.addEventListener(egret.TouchEvent.TOUCH_TAP,this.boomPaoPao,this)},e.prototype.boomPaoPao=function(t){console.log("e",t.target.name),RES.getRes("balloon_mp3").play(0,1),this.destroyPaoPao(t.target),this.booms.x=t.target.x,this.booms.y=t.target.y,this.booms.visible=!0,this.booms.gotoAndPlay(1)},e.prototype.destroyPaoPao=function(t){t.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.boomPaoPao,this),t.parent.removeChild(t),Matter.World.remove(this.engine.world,t.body,null),this.SkillPoints_count--,this.wins()},e.prototype.moveRobot=function(t){var e=this;this.robot.isPlaying?egret.Tween.removeTweens(this.robot):this.robot.gotoAndPlay(this.robot.currentFrame,-1),egret.Tween.get(this.robot,{loop:!1,onChangeObj:this}).to({x:t.stageX,y:t.stageY},7*distance(this.robot.x,t.stageX,this.robot.y,t.stageY)).call(function(){e.robot.stop()},this,[])},e.prototype.start=function(){this.SkillPoints_index=0,this.SkillPoints_count=this.SkillPoints.length,this.tips.text=tips.a,this.createPaoPao()},e.prototype.wins=function(){var t=this;0===this.SkillPoints_count&&(this.win.play(),setTimeout(function(){RES.getRes("boom_mp3").play(0,1),t.tips.text=tips.end,t.reset.visible=!0,t.next.visible=!0},3e3))},e.prototype.resets=function(){this.win.play(0),this.win.stop(),playAnimations(this.cannnonRotate,!0),this.start(),this.bronBtn.visible=!0,this.reset.visible=!1,this.next.visible=!1},e.prototype.nexts=function(){this.removeEvents(),e._parent.removeChild(this),e._parent.next()},e.prototype.createBitmapByName=function(t){var e=new egret.Bitmap,i=RES.getRes(t);return e.texture=i,e},e._instance=null,e._parent=null,e}(eui.Component);__reflect(Ball.prototype,"Ball");var config={},EgretRender=function(){function t(){}return t.create=function(e){var i={controller:t,engine:null,element:null,canvas:null,mouse:null,frameRequestId:null,options:{width:800,height:600,pixelRatio:1,background:"#fafafa",wireframeBackground:"#222222",hasBounds:!!e.bounds,enabled:!0,wireframes:!0,showSleeping:!0,showDebug:!1,showBroadphase:!1,showBounds:!1,showVelocity:!1,showCollisions:!1,showSeparations:!1,showAxes:!1,showPositions:!1,showAngleIndicator:!1,showIds:!1,showShadows:!1,showVertexNumbers:!1,showConvexHulls:!1,showInternalEdges:!1,showMousePosition:!1}},n=Matter.Common.extend(i,e);return n.mouse=e.mouse,n.engine=e.engine,n.container=n.container||egret.MainContext.instance.stage,n.bounds=n.bounds||{min:{x:0,y:0},max:{x:n.width,y:n.height}},n},t.run=function(e){egret.startTick(function(i){return t.world(e),!1},t)},t.stop=function(e){egret.stopTick(function(t){return e(),!1},t)},t.world=function(e){var i=e.engine,n=i.world,o=(e.renderer,e.container),r=e.options,s=Matter.Composite.allBodies(n),a=Matter.Composite.allConstraints(n),h=[];r.wireframes;var l=e.bounds.max.x-e.bounds.min.x,c=e.bounds.max.y-e.bounds.min.y,d=l/e.options.width,u=c/e.options.height;if(r.hasBounds){for(var p=0;p<s.length;p++){var g=s[p];g.render.sprite.visible=Matter.Bounds.overlaps(g.bounds,e.bounds)}for(var f=0;f<a.length;f++){var y=a[f],v=y.bodyA,m=y.bodyB,b=y.pointA,w=y.pointB;v&&(b=Matter.Vector.add(v.position,y.pointA,null)),m&&(w=Matter.Vector.add(m.position,y.pointB,null)),b&&w&&(Matter.Bounds.contains(e.bounds,b)||Matter.Bounds.contains(e.bounds,w))&&h.push(y)}o.scaleX=1/d,o.scaleY=1/u,o.x=-e.bounds.min.x*(1/d),o.y=-e.bounds.min.y*(1/u)}else h=a;for(p=0;p<s.length;p++)t.body(e,s[p]);for(p=0;p<h.length;p++)t.constraint(e,h[p])},t.body=function(e,i){var n=(e.engine,i.render);if(n.visible)if(i.egretSprite||n.sprite&&n.sprite.texture){var o=("b-"+i.id,i.egretSprite),r=i.container;o||(o=i.egretSprite=t._createBodySprite(e,i)),r.contains(o)||(r.addChild(o),console.log("加入容器",r.name)),o.x=i.position.x,o.y=i.position.y,o.rotation=180*i.angle/Math.PI,o.scaleX=n.sprite.xScale||1,o.scaleY=n.sprite.yScale||1}else{var o=("b-"+i.id,i.egretSprite),r=e.container;o||(o=i.egretSprite=t._createBodyPrimitive(e,i),o.initAngle=i.angle),r.contains(o)||r.addChild(o),o.x=i.position.x,o.y=i.position.y,o.rotation=180*(i.angle-o.initAngle)/Math.PI}},t._createBodySprite=function(t,e){var i=e.render,n=i.sprite.texture,o=new egret.Bitmap,r=RES.getRes(n);return o.texture=r,o.anchorOffsetX=e.render.sprite.xOffset,o.anchorOffsetY=e.render.sprite.yOffset,console.log("创建纹理",r),o.width=e.render.sprite.width,o.height=e.render.sprite.height,o},t._createBodyPrimitive=function(t,e){var i,n,o,r,s=e.render,a=t.options,h=new MatterSprite,l=[],c=h.graphics;c.clear();for(var d=e.parts.length>1?1:0;d<e.parts.length;d++){r=e.parts[d],a.wireframes?(i=null,n=16711680,o=1):(i=s.fillStyle,n=s.strokeStyle,o=s.lineWidth);for(var u=0;u<r.vertices.length;u++)l.push([r.vertices[u].x-e.position.x,r.vertices[u].y-e.position.y]);c.lineStyle(1,n),c.moveTo(l[0][0],l[0][1]);for(var p=1;p<l.length;p++)c.lineTo(l[p][0],l[p][1]);c.endFill()}return h},t.constraint=function(t,e){var i=(t.engine,e.bodyA),n=e.bodyB,o=e.pointA,r=e.pointB,s=t.container,a=e.render,h=("c-"+e.id,e.egretSprite);h||(h=e.egretSprite=new MatterSprite);var l=h.graphics;if(!a.visible||!e.pointA||!e.pointB)return void l.clear();s.contains(h)||s.addChild(h),l.clear();var c,d,u,p;i?(c=i.position.x+o.x,d=i.position.y+o.y):(c=o.x,d=o.y),n?(u=n.position.x+r.x,p=n.position.y+r.y):(u=r.x,p=r.y);var g=65280;l.lineStyle(1,g),l.moveTo(c,d),l.lineTo(u,p),l.endFill()},t}();__reflect(EgretRender.prototype,"EgretRender");var MatterSprite=function(t){function e(){return t.call(this)||this}return __extends(e,t),e}(egret.Sprite);__reflect(MatterSprite.prototype,"MatterSprite");var LoadingUI=function(t){function e(){var e=t.call(this)||this;return e.createView(),e}return __extends(e,t),e.prototype.createView=function(){this.textField=new egret.TextField,this.addChild(this.textField),this.textField.y=300,this.textField.width=480,this.textField.height=100,this.textField.textAlign="center"},e.prototype.onProgress=function(t,e){this.textField.text="Loading..."+t+"/"+e},e}(egret.Sprite);__reflect(LoadingUI.prototype,"LoadingUI",["RES.PromiseTaskReporter"]);var Main=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.GameLevels=[Stairs,Ball,Pen],e.GameLevelsIndex=-1,e}return __extends(e,t),e.prototype.createChildren=function(){t.prototype.createChildren.call(this),egret.lifecycle.addLifecycleListener(function(t){}),egret.lifecycle.onPause=function(){egret.ticker.pause()},egret.lifecycle.onResume=function(){egret.ticker.resume()};var e=new AssetAdapter;egret.registerImplementation("eui.IAssetAdapter",e),egret.registerImplementation("eui.IThemeAdapter",new ThemeAdapter),this.runGame()["catch"](function(t){console.log(t)})},e.prototype.runGame=function(){return __awaiter(this,void 0,void 0,function(){var t;return __generator(this,function(e){switch(e.label){case 0:return[4,this.loadResource()];case 1:return e.sent(),this.createGameScene(),[4,platform.login()];case 2:return e.sent(),[4,platform.getUserInfo()];case 3:return t=e.sent(),console.log(t),[2]}})})},e.prototype.loadResource=function(){return __awaiter(this,void 0,void 0,function(){var t,e;return __generator(this,function(i){switch(i.label){case 0:return i.trys.push([0,4,,5]),t=new LoadingUI,this.stage.addChild(t),[4,RES.loadConfig("resource/default.res.json","resource/")];case 1:return i.sent(),[4,this.loadTheme()];case 2:return i.sent(),[4,RES.loadGroup("preload",0,t)];case 3:return i.sent(),this.stage.removeChild(t),[3,5];case 4:return e=i.sent(),console.error(e),[3,5];case 5:return[2]}})})},e.prototype.loadTheme=function(){var t=this;return new Promise(function(e,i){var n=new eui.Theme("resource/default.thm.json",t.stage);n.addEventListener(eui.UIEvent.COMPLETE,function(){e()},t)})},e.prototype.createGameScene=function(){this.stage.stageWidth,this.stage.stageHeight;this.next()},e.prototype.next=function(){this.GameLevelsIndex++,this.addChild(this.GameLevels[this.GameLevelsIndex].getInstance(this))},e.prototype.createBitmapByName=function(t){var e=new egret.Bitmap,i=RES.getRes(t);return e.texture=i,e},e.prototype.onButtonClick=function(t){var e=new eui.Panel;e.title="Title",e.horizontalCenter=0,e.verticalCenter=0,this.addChild(e)},e}(eui.UILayer);__reflect(Main.prototype,"Main");var asd=function(_super){function asd(){var t=_super.call(this)||this;return t.LineArr=[],t.addEventListener(egret.Event.ADDED_TO_STAGE,t.onAddToStage,t),console.log("水果刀"),t}return __extends(asd,_super),asd.prototype.onAddToStage=function(t){this.stage.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onStageTouch,this),this.stage.addEventListener(egret.TouchEvent.TOUCH_MOVE,throttle(this.onStageTouch,100),this),this.stage.addEventListener(egret.TouchEvent.TOUCH_END,this.onStageTouch,this),this.addEventListener(egret.Event.ENTER_FRAME,this.clean,this)},asd.prototype.dis=function(x1,x2,y1,y2){var x1=x1,y1=eval(y1),x2=eval(x2),y2=eval(y2),calX=x2-x1,calY=y2-y1;return Math.pow(calX*calX+calY*calY,.5)},asd.prototype.createLine=function(t,e){var i=this.createBitmapByName("paopao_png");i.type=0,i.width=130,i.height=130,i.x=t,i.y=e,i.scaleX=.2,i.scaleY=.2,i.anchorOffsetX=i.width/2,i.anchorOffsetY=i.height/2,this.addChild(i),this.LineArr.push(i)},asd.prototype.onStageTouch=function(t){"touchBegin"==t.type||("touchMove"==t.type?this.createLine(t.stageX,t.stageY):"touchEnd"==t.type)},asd.prototype.clean=function(){if(this.LineArr.length>0){console.log(this.LineArr.length);for(var t=0;t<this.LineArr.length;t++)this.LineArr[t].scaleX<.6&&0==this.LineArr[t].type?(this.LineArr[t].scaleX=this.LineArr[t].scaleX+.02,this.LineArr[t].scaleY=this.LineArr[t].scaleY+.02):(this.LineArr[t].type=1,this.LineArr[t].scaleX=this.LineArr[t].scaleX-.01,this.LineArr[t].scaleY=this.LineArr[t].scaleY-.01,this.LineArr[t].scaleX<=0&&(this.removeChild(this.LineArr[t]),this.LineArr.splice(t,1),t--))}},asd.prototype.createBitmapByName=function(t){var e=new egret.Bitmap,i=RES.getRes(t);return e.texture=i,e},asd}(egret.DisplayObjectContainer);__reflect(asd.prototype,"asd");var Pen=function(t){function e(){var e=t.call(this)||this;return e.name="Pen",e.SkillPoints=tips.SkillPoints,e.SkillPoints_index=0,e.SkillPoints_count=0,e.Points=[],e.drawPoints=[],e.bugNum=0,console.log("map constructor",e),e.addEventListener(eui.UIEvent.CREATION_COMPLETE,e.init,e),e.skinName="PenSkin",e}return __extends(e,t),e.getInstance=function(t){return null===this._instance&&(this._instance=new e,this._parent=t),e._instance},e.prototype.childrenCreated=function(){console.log("childrenCreated",this.bottoms.x),playAnimation(this.cannnonRotate,!0)},e.prototype.init=function(){var t=this;console.log("init",this.bottoms.x,this.bottoms);var e=(Matter.Engine,Matter.Render,Matter.Runner,Matter.MouseConstraint,Matter.Mouse,Matter.World,Matter.Bodies,this.engine=Matter.Engine.create(null,{})),i=e.world,n=Matter.Runner.create(null);n.isFixed=!0;var o=EgretRender.create({element:this,engine:e,options:{width:this.width,height:this.height,container:this,wireframes:!0}});i.bounds.max={x:this.width,y:this.height},Matter.Runner.run(n,e),EgretRender.run(o),e.world.gravity.y=.2,console.log("容器",Matter.Bodies,this.lefts.height);var r=(Matter.Body.nextGroup(!1),Matter.Bodies.rectangle(this.lefts.x,this.lefts.y,this.lefts.width,this.lefts.height,{isStatic:!0,friction:.2,container:this,egretSprite:this.lefts})),s=Matter.Bodies.rectangle(this.rights.x,this.rights.y,this.rights.width,this.rights.height,{isStatic:!0,friction:.2,container:this,egretSprite:this.rights});Matter.World.add(e.world,[Matter.Bodies.rectangle(this.tops.x,this.tops.y,this.tops.width,this.tops.height,{isStatic:!0,friction:.2,container:this,egretSprite:this.tops}),Matter.Bodies.rectangle(this.bottoms.x,this.bottoms.y,this.bottoms.width,this.bottoms.height,{isStatic:!0,friction:0,container:this,egretSprite:this.bottoms,collisionFilter:{group:1}}),r,s]),console.log("world",i,s);var a=0;Matter.Events.on(e,"collisionStart",function(e){var i=e.pairs;a++;for(var n=0;n<i.length;n++){var o=i[n];console.log("kk:"+a,o,i),"line"===o.bodyB.label}var r=i[0].bodyA.parent,s=i[0].bodyB.parent;t.checkCrashBug(s,i),t.checkCrashBug(r,i),"linebox"===r.label&&r.isStatic&&1===i.length}),this.tips.text=tips.a,this.addEvents()},e.prototype.checkCrashBug=function(t,e){if("linebox"===t.label&&e.length>10)Matter.Body.setStatic(t,!0),console.log("多个刚体触发 静态");else if("linebox"===t.label&&!t.isStatic)if(t.nowtime){t.times++;var i=(Date.now()-t.nowtime)/1e3;(i>1&&t.times>5||1>i&&t.times>10)&&(Matter.Body.setStatic(t,!0),delete t.times,delete t.nowtime,console.log("碰撞次数超限 静态"))}else t.nowtime=Date.now(),t.times=1},e.prototype.addEvents=function(){this.bronBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.tapBtn,this),this.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.drawLineStart,this),this.addEventListener(egret.TouchEvent.TOUCH_MOVE,this.drawLineMove,this),this.addEventListener(egret.TouchEvent.TOUCH_END,this.drawLineEnd,this)},e.prototype.drawLineStart=function(t){console.log(t.stageX,t.stageY),this.startPoint={x:t.stageX,y:t.stageY},this.Points.push(this.startPoint),this.drawPoints=[]},e.prototype.drawLineMove=function(t){console.log(this.Points.length);var e={x:t.stageX,y:t.stageY};if(this.Points.length>=5){var i=this.Points[Math.floor(this.Points.length/2)].y,n=this.Points[Math.floor(this.Points.length/2)].x,o=this.startPoint.y,r=this.startPoint.x,s=e.y,a=e.x;(i-s)/(o-s)===(n-a)/(r-a)?console.log("是直线"):(this.drawPoints.push([this.startPoint,e]),this.Points=[],this.startPoint=e,this.Points.push(this.startPoint))}this.Points.push(e)},e.prototype.drawLineEnd=function(t){var e=this;if(0!=this.drawPoints.length){console.log(this.drawPoints);var i=[],n=new egret.Shape;n.graphics.lineStyle(2,0),n.graphics.moveTo(this.drawPoints[0][0].x,this.drawPoints[0][0].y);var o=Matter.Body.nextGroup(!0);this.drawPoints.forEach(function(t,r,s){var a=Math.abs(t[0].x-t[1].x),h=Math.abs(t[0].y-t[1].y),l=Math.sqrt(Math.pow(a,2)+Math.pow(h,2)),c=s[r+1];if(c){var d=t[0],u={x:t[1].x,y:t[1].y},p=((u.y-d.y)/(u.x-d.x),Math.atan2(u.y-d.y,u.x-d.x)),g=Matter.Bodies.rectangle(t[0].x,t[0].y,l,1,{angle:p,container:e,slop:0,restitution:0,collisionFilter:{group:o},label:"line",friction:0,frictionAir:0,frictionStatic:0});g.P=t,g.dis=l,i.push(g),n.graphics.lineTo(t[1].x,t[1].y)}}),console.log("group",o),n.graphics.endFill();var r=Matter.Body.create({parts:i,container:this,slop:0,restitution:0,label:"linebox",collisionFilter:{category:4,mask:4,group:1},startPoint:{x:this.drawPoints[0][0].x,y:this.drawPoints[0][0].y}});this.addEventListener(egret.Event.ENTER_FRAME,function(){n.x=r.position.x-r.startPoint.x-n.width/2,n.y=r.position.y-r.startPoint.y-n.height/2,n.rotation=r.angle/(360/Math.PI)},this),Matter.World.add(this.engine.world,r),console.log(i)}},e.prototype.removeEvents=function(){this.bronBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.tapBtn,this)},e.prototype.tapBtn=function(){this.SkillPoints_index++,this.SkillPoints_index===this.SkillPoints.length&&(this.bronBtn.visible=!1,this.tips.text=tips.b,this.cannnonRotate.stop())},e.prototype.update=function(){},e.prototype.createBitmapByName=function(t){var e=new egret.Bitmap,i=RES.getRes(t);return e.texture=i,e},e._instance=null,e._parent=null,e}(eui.Component);__reflect(Pen.prototype,"Pen");var DebugPlatform=function(){function t(){}return t.prototype.getUserInfo=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return[2,{nickName:"username"}]})})},t.prototype.login=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return[2]})})},t}();__reflect(DebugPlatform.prototype,"DebugPlatform",["Platform"]),window.platform||(window.platform=new DebugPlatform);var tip1="应聘岗位：前端工程师    到岗时间：一周内  \n基本信息：男 27岁 统招大专  5年工作经验  籍贯湖北荆州 \n手机/微信：15874137662  邮箱：357201017@qq.com  湖南工程职业学院      2011.9-2014.7 大专      工程造价 \n 湖南岳阳市第四中学       2008.9-2011.7  高中      理科  深圳姝承教育公司    2018.06-2019.07 Web前端 \n 工作内容：小程序和移动端网页 \n\n 湖南健盟网络科技   2017.08-2018.06  Web前端 \n 工作内容：微信公众号和小程序 \n\n 湖南联晶网络科技  2016.01-2017.07   Web前端 \n 工作内容：开发网站 \n\n 湖南后景网络科技   2015.02-2015.12  H5游戏前端 \n 工作内容：用H5白鹭框架做微信端Canvas游戏",Stairs=function(t){function e(){var e=t.call(this)||this;return e.name="Stairs",e.statusGame="game",e.grounds=[],e.addEventListener(eui.UIEvent.CREATION_COMPLETE,e.init,e),e.skinName="StairsSkin",e.tips=tip1.split(" ").filter(function(t){return t.length}),e.height=300*(e.tips.length+1),e.map.height=300*e.tips.length,e}return __extends(e,t),e.getInstance=function(t){return null===this._instance&&(this._instance=new e,this._parent=t),e._instance},e.prototype.init=function(){this.addEvents(),this.physics(),this.loadGround(),this.loadRobot()},e.prototype.addEvents=function(){this.addEventListener(egret.TouchEvent.TOUCH_TAP,this.moveRobot,this),this.reset.addEventListener(egret.TouchEvent.TOUCH_TAP,this.resets,this)},e.prototype.loadGround=function(){var t=this;this.tips.forEach(function(e,i){var n=new eui.Button;n.label=e.replace(/[\r\n]/g,""),n.width=25*e.length<150?25*e.length:150,n.height=70,n.maxWidth=300,n.minWidth=100,n.maxHeight=100,n.minHeight=40,n.anchorOffsetX=n.width/2,n.anchorOffsetY=n.height/2,n.x=RandomNumBoth_Int(n.width/2,t.width-n.width/2),n.y=300*(i+1);var o=Matter.Bodies.rectangle(n.x,n.y,n.width,n.height,{isStatic:!0,friction:.2,container:t,restitution:.1,label:i>0?"ground Body":"ground",egretSprite:n});t.grounds.push(o),Matter.World.add(t.engine.world,[o])}),this.bottoms.y=this.lefts.height=this.rights.height=this.height,this.lefts.anchorOffsetY=this.rights.anchorOffsetY=this.lefts.y=this.rights.y=this.height/2;var e=Matter.Bodies.rectangle(this.lefts.x,this.lefts.y,this.lefts.width,this.lefts.height,{isStatic:!0,friction:.2,container:this,egretSprite:this.lefts}),i=Matter.Bodies.rectangle(this.rights.x,this.rights.y,this.rights.width,this.rights.height,{isStatic:!0,friction:.2,container:this,egretSprite:this.rights});Matter.World.add(this.engine.world,[Matter.Bodies.rectangle(this.tops.x,this.tops.y,this.tops.width,this.tops.height,{isStatic:!0,friction:.2,container:this,egretSprite:this.tops}),Matter.Bodies.rectangle(this.bottoms.x,this.bottoms.y,this.bottoms.width,this.bottoms.height,{isStatic:!0,friction:0,container:this,egretSprite:this.bottoms,label:"bottom",collisionFilter:{group:1}}),e,i])},e.prototype.loadRobot=function(){var t=this,i=RES.getRes("robot_json"),n=RES.getRes("robot_png"),o=new egret.MovieClipDataFactory(i,n),r=this.robot=new egret.MovieClip(o.generateMovieClipData("walk"));r.frameRate=42,r.scaleX=r.scaleY=.2,r.width=r.height=100,r.anchorOffsetX=160,r.anchorOffsetY=180,r.x=150,r.y=150,this.addChild(r);var s=this.robot_phy=Matter.Bodies.circle(this.robot.x,this.robot.y+10,3*this.robot.width/6,{friction:.3,container:this,restitution:.1},20);Matter.World.add(this.engine.world,[s]),this.addEventListener(egret.Event.ENTER_FRAME,function(){r.x=s.position.x,r.y=s.position.y,(s.velocity.x<.001&&s.velocity.x>0||s.velocity.x>-.001&&s.velocity.x<0)&&t.robot.stop(),"game"==t.statusGame&&r.y>-t.y+e._parent.height+t.robot.height/2&&(console.log("出界"),t.fail())},this)},e.prototype.moveRobot=function(t){if("game"==this.statusGame){console.log(t);var e,i;this.robot.gotoAndPlay(this.robot.currentFrame,-1),t.stageX>this.robot.x?(this.robot.scaleX=Math.abs(this.robot.scaleX),e=.05):(this.robot.scaleX=-1*Math.abs(this.robot.scaleX),e=-.05),i=t.stageY-this.y+this.robot.height/2<this.robot.y?-.1:0,console.log(e,i,this.robot_phy.velocity.y),this.robot_phy.velocity.y<-1&&(i=0),Matter.Body.applyForce(this.robot_phy,this.robot_phy.position,{x:e,y:i})}},e.prototype.physics=function(){var t=this,e=(Matter.Engine,Matter.Render,Matter.Runner,Matter.MouseConstraint,Matter.Mouse,Matter.World,Matter.Bodies,this.engine=Matter.Engine.create(null,{})),i=e.world,n=Matter.Runner.create(null);n.isFixed=!0;var o=EgretRender.create({element:this,engine:e,options:{width:this.width,height:this.height,container:this,wireframes:!0}});i.bounds.max={x:this.width,y:this.height},Matter.Runner.run(n,e),EgretRender.run(o),e.world.gravity.y=.4,Matter.Events.on(e,"collisionStart",function(e){if("game"==t.statusGame)for(var i=e.pairs,n=0;n<i.length;n++){var o=i[n];console.log("kk:",o),"ground Body"===o.bodyB.label?(o.bodyB.label="ground end",egret.Tween.get(t,{loop:!1,onChangeObj:t}).to({y:t.y-300},500).call(function(){},t,[])):"ground Body"===o.bodyA.label?(o.bodyA.label="Rectangle end",egret.Tween.get(t,{loop:!1,onChangeObj:t}).to({y:t.y-300},1e3).call(function(){},t,[])):("bottom"===o.bodyA.label||"bottom"===o.bodyB.label)&&t.success()}})},e.prototype.fail=function(){this.statusGame="fail",this.reset.visible=!0,this.reset.y=-this.y+e._parent.height/2,this.reset.x=this.width/2,this.robot.stop(),this.addChild(this.reset)},e.prototype.success=function(){this.statusGame="success",RES.getRes("wind_mp3").play(0,1),Matter.World.remove(this.engine.world,this.robot_phy,null),egret.Tween.get(this.robot,{loop:!1,onChangeObj:this}).to({y:50},5e3).call(function(){},this,[]),egret.Tween.get(this,{loop:!1,onChangeObj:this}).to({y:0},5e3)},e.prototype.resets=function(){var t=this;egret.Tween.get(this,{loop:!1,onChangeObj:this}).to({y:0},-this.y).call(function(){Matter.Body.setPosition(t.robot_phy,{x:150,y:150}),Matter.Body.setVelocity(t.robot_phy,{x:0,y:0}),t.reset.visible=!1,t.statusGame="game",t.grounds.forEach(function(t,e){t.label=e>0?"ground Body":"ground"})},this,[])},e._instance=null,e._parent=null,e}(eui.Component);__reflect(Stairs.prototype,"Stairs");var ThemeAdapter=function(){function t(){}return t.prototype.getTheme=function(t,e,i,n){function o(t){e.call(n,t)}function r(e){e.resItem.url==t&&(RES.removeEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,r,null),i.call(n))}var s=this;if("undefined"!=typeof generateEUI)egret.callLater(function(){e.call(n,generateEUI)},this);else if("undefined"!=typeof generateEUI2)RES.getResByUrl("resource/gameEui.json",function(t,i){window.JSONParseClass.setData(t),egret.callLater(function(){e.call(n,generateEUI2)},s)},this,RES.ResourceItem.TYPE_JSON);else if("undefined"!=typeof generateJSON)if(t.indexOf(".exml")>-1){var a=t.split("/");a.pop();var h=a.join("/")+"_EUI.json";generateJSON.paths[t]?egret.callLater(function(){e.call(n,generateJSON.paths[t])},this):RES.getResByUrl(h,function(i){window.JSONParseClass.setData(i),egret.callLater(function(){e.call(n,generateJSON.paths[t])},s)},this,RES.ResourceItem.TYPE_JSON)}else egret.callLater(function(){e.call(n,generateJSON)},this);else RES.addEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,r,null),RES.getResByUrl(t,o,this,RES.ResourceItem.TYPE_TEXT)},t}();__reflect(ThemeAdapter.prototype,"ThemeAdapter",["eui.IThemeAdapter"]);